[{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\activities\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":6,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":69,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle"},"fix":{"range":[211,224],"text":""},"desc":"Remove unused variable \"CheckCircle\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { createClient } from '@/lib/supabase/client';\nimport Navbar from '@/components/Navbar';\nimport { Palette, Music, Gamepad2, BookOpen, Star, Lock, CheckCircle } from 'lucide-react';\nimport styles from './Activities.module.css';\n\nconst supabase = createClient();\n\ninterface Activity {\n    id: string;\n    title: string;\n    content_type: string;\n    island_code: string;\n    slug: string;\n    published: boolean;\n}\n\nconst activityIcons: Record<string, React.ReactNode> = {\n    activity: <Palette size={24} />,\n    game: <Gamepad2 size={24} />,\n    song: <Music size={24} />,\n    story: <BookOpen size={24} />,\n};\n\nconst islandColors: Record<string, string> = {\n    TT: '#FF3366',\n    JM: '#00FF94',\n    HT: '#7000FF',\n    LC: '#00F5FF',\n    GY: '#FFB800',\n};\n\nexport default function ActivitiesPage() {\n    const [activities, setActivities] = useState<Activity[]>([]);\n    const [filter, setFilter] = useState<string>('all');\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        async function fetchActivities() {\n            const query = supabase\n                .from('content_items')\n                .select('id, title, content_type, island_code, slug, published')\n                .eq('published', true)\n                .in('content_type', ['activity', 'game', 'song']);\n\n            if (filter !== 'all') {\n                query.eq('content_type', filter);\n            }\n\n            const { data } = await query.order('created_at', { ascending: false });\n            setActivities(data || []);\n            setLoading(false);\n        }\n\n        fetchActivities();\n    }, [filter]);\n\n    const categories = [\n        { id: 'all', label: 'All Activities', icon: <Star size={18} /> },\n        { id: 'activity', label: 'Arts & Crafts', icon: <Palette size={18} /> },\n        { id: 'game', label: 'Games', icon: <Gamepad2 size={18} /> },\n        { id: 'song', label: 'Songs', icon: <Music size={18} /> },\n    ];\n\n    return (\n        <div className={styles.page}>\n            <Navbar />\n            \n            <header className={styles.header}>\n                <div className={styles.container}>\n                    <h1 className={styles.title}>\n                        Island <span className=\"gradient-text\">Activities</span>\n                    </h1>\n                    <p className={styles.subtitle}>\n                        Fun games, crafts, and songs celebrating Caribbean culture\n                    </p>\n                </div>\n            </header>\n\n            <main className={styles.container}>\n                <div className={styles.filters}>\n                    {categories.map((cat) => (\n                        <button\n                            key={cat.id}\n                            className={`${styles.filterBtn} ${filter === cat.id ? styles.active : ''}`}\n                            onClick={() => setFilter(cat.id)}\n                        >\n                            {cat.icon}\n                            <span>{cat.label}</span>\n                        </button>\n                    ))}\n                </div>\n\n                {loading ? (\n                    <div className={styles.loading}>Loading activities...</div>\n                ) : activities.length === 0 ? (\n                    <div className={styles.empty}>\n                        <Palette size={48} />\n                        <h3>Activities Coming Soon!</h3>\n                        <p>We&apos;re preparing exciting activities for you. Check back soon!</p>\n                    </div>\n                ) : (\n                    <div className={styles.grid}>\n                        {activities.map((activity) => (\n                            <div\n                                key={activity.id}\n                                className={`${styles.card} glass-card`}\n                                style={{ '--accent': islandColors[activity.island_code] || '#7000FF' } as React.CSSProperties}\n                            >\n                                <div className={styles.cardIcon}>\n                                    {activityIcons[activity.content_type] || <Star size={24} />}\n                                </div>\n                                <h3>{activity.title}</h3>\n                                <span className={styles.tag}>{activity.content_type}</span>\n                                <button className={styles.playBtn}>\n                                    Start Activity\n                                </button>\n                            </div>\n                        ))}\n                    </div>\n                )}\n\n                <section className={styles.comingSoon}>\n                    <h2>Coming Soon</h2>\n                    <div className={styles.previewGrid}>\n                        {[\n                            { title: 'Color the Caribbean Map', type: 'activity', locked: true },\n                            { title: 'Island Matching Game', type: 'game', locked: true },\n                            { title: 'Calypso Sing-Along', type: 'song', locked: true },\n                            { title: 'Make a Steel Pan', type: 'activity', locked: true },\n                        ].map((item, idx) => (\n                            <div key={idx} className={`${styles.previewCard} glass-card`}>\n                                <Lock size={20} className={styles.lockIcon} />\n                                <span className={styles.previewTitle}>{item.title}</span>\n                                <span className={styles.previewType}>{item.type}</span>\n                            </div>\n                        ))}\n                    </div>\n                </section>\n            </main>\n\n            <footer className={styles.footer}>\n                <p>┬⌐ 2026 Likkle Legends. Handcrafted for the diaspora.</p>\n            </footer>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\admin\\activities\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Link' is defined but never used.","line":5,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Link"},"fix":{"range":[114,144],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'assetUrl' is assigned a value but never used.","line":46,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":20},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchActivities` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\admin\\activities\\page.tsx:49:9\n  47 |\n  48 |     useEffect(() => {\n> 49 |         fetchActivities();\n     |         ^^^^^^^^^^^^^^^ `fetchActivities` accessed before it is declared\n  50 |     }, []);\n  51 |\n  52 |     async function fetchActivities() {\n\nC:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\admin\\activities\\page.tsx:52:5\n  50 |     }, []);\n  51 |\n> 52 |     async function fetchActivities() {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 53 |         const { data } = await supabase\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 54 |             .from('content_items')\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 55 |             .select('*')\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 56 |             .in('content_type', ['activity', 'game', 'song'])\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 57 |             .order('created_at', { ascending: false });\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 58 |         setActivities(data || []);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 59 |         setLoading(false);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 60 |     }\n     | ^^^^^^ `fetchActivities` is declared here\n  61 |\n  62 |     async function handleCreate(e: React.FormEvent) {\n  63 |         e.preventDefault();","line":49,"column":9,"nodeType":null,"endLine":49,"endColumn":24}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { createClient } from '@/lib/supabase/client';\nimport Link from 'next/link';\nimport { Plus, Palette, Music, Gamepad2, Trash2, Edit, Eye, Globe } from 'lucide-react';\nimport FileUpload from '@/components/FileUpload';\nimport styles from './AdminActivities.module.css';\n\nconst supabase = createClient();\n\ninterface Activity {\n    id: string;\n    title: string;\n    content_type: string;\n    island_code: string;\n    slug: string;\n    published: boolean;\n    created_at: string;\n}\n\nconst activityTypes = [\n    { id: 'activity', label: 'Arts & Crafts', icon: <Palette size={18} /> },\n    { id: 'game', label: 'Game', icon: <Gamepad2 size={18} /> },\n    { id: 'song', label: 'Song', icon: <Music size={18} /> },\n];\n\nconst islands = [\n    { code: 'TT', name: 'Trinidad & Tobago' },\n    { code: 'JM', name: 'Jamaica' },\n    { code: 'HT', name: 'Haiti' },\n    { code: 'LC', name: 'St. Lucia' },\n    { code: 'GY', name: 'Guyana' },\n];\n\nexport default function AdminActivitiesPage() {\n    const [activities, setActivities] = useState<Activity[]>([]);\n    const [showCreate, setShowCreate] = useState(false);\n    const [loading, setLoading] = useState(true);\n    const [formData, setFormData] = useState({\n        title: '',\n        content_type: 'activity',\n        island_code: 'TT',\n        slug: '',\n    });\n    const [assetUrl, setAssetUrl] = useState('');\n\n    useEffect(() => {\n        fetchActivities();\n    }, []);\n\n    async function fetchActivities() {\n        const { data } = await supabase\n            .from('content_items')\n            .select('*')\n            .in('content_type', ['activity', 'game', 'song'])\n            .order('created_at', { ascending: false });\n        setActivities(data || []);\n        setLoading(false);\n    }\n\n    async function handleCreate(e: React.FormEvent) {\n        e.preventDefault();\n        const slug = formData.slug || formData.title.toLowerCase().replace(/\\s+/g, '-');\n        \n        const { error } = await supabase.from('content_items').insert({\n            ...formData,\n            slug,\n            published: false,\n        });\n\n        if (!error) {\n            setShowCreate(false);\n            setFormData({ title: '', content_type: 'activity', island_code: 'TT', slug: '' });\n            setAssetUrl('');\n            fetchActivities();\n        }\n    }\n\n    async function togglePublish(id: string, currentStatus: boolean) {\n        await supabase.from('content_items').update({ published: !currentStatus }).eq('id', id);\n        fetchActivities();\n    }\n\n    async function deleteActivity(id: string) {\n        if (confirm('Delete this activity?')) {\n            await supabase.from('content_items').delete().eq('id', id);\n            fetchActivities();\n        }\n    }\n\n    return (\n        <div className={styles.container}>\n            <header className={styles.header}>\n                <div>\n                    <h1>Activities Manager</h1>\n                    <p className={styles.subtitle}>Create and manage activities for the kids portal</p>\n                </div>\n                <button className={styles.createBtn} onClick={() => setShowCreate(true)}>\n                    <Plus size={18} /> New Activity\n                </button>\n            </header>\n\n            {showCreate && (\n                <div className={styles.modal}>\n                    <div className={`${styles.modalContent} glass-card`}>\n                        <h2>Create New Activity</h2>\n                        <form onSubmit={handleCreate}>\n                            <div className={styles.field}>\n                                <label>Title</label>\n                                <input\n                                    type=\"text\"\n                                    value={formData.title}\n                                    onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                                    placeholder=\"e.g. Color the Caribbean Map\"\n                                    required\n                                />\n                            </div>\n\n                            <div className={styles.row}>\n                                <div className={styles.field}>\n                                    <label>Type</label>\n                                    <select\n                                        value={formData.content_type}\n                                        onChange={(e) => setFormData({ ...formData, content_type: e.target.value })}\n                                    >\n                                        {activityTypes.map((t) => (\n                                            <option key={t.id} value={t.id}>{t.label}</option>\n                                        ))}\n                                    </select>\n                                </div>\n                                <div className={styles.field}>\n                                    <label>Island</label>\n                                    <select\n                                        value={formData.island_code}\n                                        onChange={(e) => setFormData({ ...formData, island_code: e.target.value })}\n                                    >\n                                        {islands.map((i) => (\n                                            <option key={i.code} value={i.code}>{i.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n                            </div>\n\n                            <FileUpload\n                                bucket=\"activities\"\n                                path={`${formData.content_type}/${formData.island_code}`}\n                                accept=\"image/*,application/pdf\"\n                                label=\"Activity Asset (Image or PDF)\"\n                                onUploadComplete={(url) => setAssetUrl(url)}\n                                onError={(err) => console.error(err)}\n                            />\n\n                            <div className={styles.actions}>\n                                <button type=\"button\" className={styles.cancelBtn} onClick={() => setShowCreate(false)}>\n                                    Cancel\n                                </button>\n                                <button type=\"submit\" className={styles.submitBtn}>\n                                    Create Activity\n                                </button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            )}\n\n            <div className={styles.stats}>\n                <div className=\"glass-card\">\n                    <p>Total Activities</p>\n                    <h3>{activities.length}</h3>\n                </div>\n                <div className=\"glass-card\">\n                    <p>Published</p>\n                    <h3>{activities.filter(a => a.published).length}</h3>\n                </div>\n                <div className=\"glass-card\">\n                    <p>Drafts</p>\n                    <h3>{activities.filter(a => !a.published).length}</h3>\n                </div>\n            </div>\n\n            <section className={`${styles.tableSection} glass-card`}>\n                <table className={styles.table}>\n                    <thead>\n                        <tr>\n                            <th>Title</th>\n                            <th>Type</th>\n                            <th>Island</th>\n                            <th>Status</th>\n                            <th>Actions</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {loading ? (\n                            <tr><td colSpan={5} className={styles.loading}>Loading...</td></tr>\n                        ) : activities.length === 0 ? (\n                            <tr><td colSpan={5} className={styles.empty}>No activities yet. Create your first one!</td></tr>\n                        ) : activities.map((activity) => (\n                            <tr key={activity.id}>\n                                <td>{activity.title}</td>\n                                <td>\n                                    <span className={styles.typeBadge}>\n                                        {activityTypes.find(t => t.id === activity.content_type)?.icon}\n                                        {activity.content_type}\n                                    </span>\n                                </td>\n                                <td>{activity.island_code}</td>\n                                <td>\n                                    <span className={activity.published ? styles.published : styles.draft}>\n                                        {activity.published ? 'Published' : 'Draft'}\n                                    </span>\n                                </td>\n                                <td>\n                                    <div className={styles.actionBtns}>\n                                        <button\n                                            title={activity.published ? 'Unpublish' : 'Publish'}\n                                            onClick={() => togglePublish(activity.id, activity.published)}\n                                        >\n                                            <Globe size={16} />\n                                        </button>\n                                        <button title=\"Preview\">\n                                            <Eye size={16} />\n                                        </button>\n                                        <button title=\"Edit\">\n                                            <Edit size={16} />\n                                        </button>\n                                        <button\n                                            title=\"Delete\"\n                                            className={styles.deleteBtn}\n                                            onClick={() => deleteActivity(activity.id)}\n                                        >\n                                            <Trash2 size={16} />\n                                        </button>\n                                    </div>\n                                </td>\n                            </tr>\n                        ))}\n                    </tbody>\n                </table>\n            </section>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\admin\\ai\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\admin\\ai\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\admin\\books\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\admin\\content-studio\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\admin\\coppa\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\admin\\coppa\\training\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\admin\\growth\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\admin\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\admin\\messaging\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\admin\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\admin\\teachers\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Star' is defined but never used.","line":7,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":29,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Star"},"fix":{"range":[205,211],"text":""},"desc":"Remove unused variable \"Star\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { createClient } from '@/lib/supabase/client';\nimport {\n    GraduationCap, Users, BookOpen, Download, Plus, Search,\n    CheckCircle, Clock, Star, Filter, BarChart3, FileText\n} from 'lucide-react';\nimport styles from './Teachers.module.css';\n\nconst supabase = createClient();\n\ninterface Teacher {\n    id: string;\n    user_id: string;\n    school_name: string;\n    teacher_count: number;\n    student_count: number;\n    verified: boolean;\n    created_at: string;\n    user?: { first_name: string; email: string };\n}\n\ninterface ContentItem {\n    id: string;\n    title: string;\n    content_type: string;\n    island_code: string;\n    published: boolean;\n}\n\nexport default function TeacherPortalPage() {\n    const [teachers, setTeachers] = useState<Teacher[]>([]);\n    const [content, setContent] = useState<ContentItem[]>([]);\n    const [activeTab, setActiveTab] = useState<'overview' | 'teachers' | 'resources' | 'curriculum'>('overview');\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        async function fetchData() {\n            const [teachersRes, contentRes] = await Promise.all([\n                supabase.from('educator_accounts').select('*, user:users(first_name, email)'),\n                supabase.from('content_items').select('*').eq('published', true).limit(20)\n            ]);\n            setTeachers(teachersRes.data || []);\n            setContent(contentRes.data || []);\n            setLoading(false);\n        }\n        fetchData();\n    }, []);\n\n    const verifiedTeachers = teachers.filter(t => t.verified).length;\n    const totalStudents = teachers.reduce((sum, t) => sum + (t.student_count || 0), 0);\n\n    return (\n        <div className={styles.container}>\n            <header className={styles.header}>\n                <div>\n                    <h1><GraduationCap size={28} /> Teacher Portal</h1>\n                    <p className={styles.subtitle}>Manage educators, curriculum resources, and student progress</p>\n                </div>\n                <button className={styles.primaryBtn}>\n                    <Plus size={18} /> Invite Teacher\n                </button>\n            </header>\n\n            <div className={styles.tabs}>\n                {[\n                    { id: 'overview', label: 'Overview', icon: <BarChart3 size={18} /> },\n                    { id: 'teachers', label: 'Teachers', icon: <Users size={18} /> },\n                    { id: 'resources', label: 'Resources', icon: <BookOpen size={18} /> },\n                    { id: 'curriculum', label: 'Curriculum', icon: <FileText size={18} /> },\n                ].map((tab) => (\n                    <button\n                        key={tab.id}\n                        className={`${styles.tab} ${activeTab === tab.id ? styles.active : ''}`}\n                        onClick={() => setActiveTab(tab.id as typeof activeTab)}\n                    >\n                        {tab.icon} {tab.label}\n                    </button>\n                ))}\n            </div>\n\n            {activeTab === 'overview' && (\n                <div className={styles.overviewGrid}>\n                    <div className={`glass-card ${styles.statCard}`}>\n                        <div className={styles.statIcon}><GraduationCap size={24} /></div>\n                        <div>\n                            <p className={styles.statLabel}>Total Teachers</p>\n                            <h3>{teachers.length}</h3>\n                        </div>\n                    </div>\n                    <div className={`glass-card ${styles.statCard}`}>\n                        <div className={styles.statIcon} style={{ background: 'rgba(0, 255, 148, 0.1)', color: '#00FF94' }}>\n                            <CheckCircle size={24} />\n                        </div>\n                        <div>\n                            <p className={styles.statLabel}>Verified</p>\n                            <h3>{verifiedTeachers}</h3>\n                        </div>\n                    </div>\n                    <div className={`glass-card ${styles.statCard}`}>\n                        <div className={styles.statIcon} style={{ background: 'rgba(0, 245, 255, 0.1)', color: '#00F5FF' }}>\n                            <Users size={24} />\n                        </div>\n                        <div>\n                            <p className={styles.statLabel}>Total Students</p>\n                            <h3>{totalStudents}</h3>\n                        </div>\n                    </div>\n                    <div className={`glass-card ${styles.statCard}`}>\n                        <div className={styles.statIcon} style={{ background: 'rgba(255, 184, 0, 0.1)', color: '#FFB800' }}>\n                            <BookOpen size={24} />\n                        </div>\n                        <div>\n                            <p className={styles.statLabel}>Resources</p>\n                            <h3>{content.length}</h3>\n                        </div>\n                    </div>\n\n                    <div className={`glass-card ${styles.recentSection}`}>\n                        <h3>Recent Teacher Signups</h3>\n                        {teachers.slice(0, 5).map((teacher) => (\n                            <div key={teacher.id} className={styles.teacherRow}>\n                                <div className={styles.teacherInfo}>\n                                    <span className={styles.teacherName}>{teacher.user?.first_name || 'Teacher'}</span>\n                                    <span className={styles.schoolName}>{teacher.school_name}</span>\n                                </div>\n                                <span className={teacher.verified ? styles.verified : styles.pending}>\n                                    {teacher.verified ? 'Verified' : 'Pending'}\n                                </span>\n                            </div>\n                        ))}\n                        {teachers.length === 0 && <p className={styles.empty}>No teachers yet</p>}\n                    </div>\n\n                    <div className={`glass-card ${styles.curriculumPreview}`}>\n                        <h3>Caribbean Curriculum Areas</h3>\n                        <div className={styles.curriculumGrid}>\n                            {[\n                                { name: 'Literacy', color: '#FF3366', count: 24 },\n                                { name: 'Numeracy', color: '#7000FF', count: 18 },\n                                { name: 'Science', color: '#00FF94', count: 12 },\n                                { name: 'Culture', color: '#00F5FF', count: 30 },\n                                { name: 'Arts', color: '#FFB800', count: 15 },\n                                { name: 'Music', color: '#FF6B00', count: 20 },\n                            ].map((area) => (\n                                <div key={area.name} className={styles.curriculumItem}>\n                                    <div className={styles.curriculumBar} style={{ background: area.color, width: `${area.count * 2}%` }} />\n                                    <span>{area.name}</span>\n                                    <span className={styles.curriculumCount}>{area.count}</span>\n                                </div>\n                            ))}\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            {activeTab === 'teachers' && (\n                <div className={styles.teachersSection}>\n                    <div className={styles.searchBar}>\n                        <Search size={18} />\n                        <input type=\"text\" placeholder=\"Search teachers...\" />\n                        <button><Filter size={18} /> Filter</button>\n                    </div>\n\n                    <div className={`glass-card ${styles.tableCard}`}>\n                        <table className={styles.table}>\n                            <thead>\n                                <tr>\n                                    <th>Teacher</th>\n                                    <th>School</th>\n                                    <th>Students</th>\n                                    <th>Status</th>\n                                    <th>Actions</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {loading ? (\n                                    <tr><td colSpan={5} className={styles.loading}>Loading...</td></tr>\n                                ) : teachers.length === 0 ? (\n                                    <tr><td colSpan={5} className={styles.empty}>No teachers registered yet</td></tr>\n                                ) : teachers.map((teacher) => (\n                                    <tr key={teacher.id}>\n                                        <td>\n                                            <div className={styles.teacherCell}>\n                                                <div className={styles.avatar}>{teacher.user?.first_name?.[0] || 'T'}</div>\n                                                <div>\n                                                    <p>{teacher.user?.first_name || 'Teacher'}</p>\n                                                    <small>{teacher.user?.email}</small>\n                                                </div>\n                                            </div>\n                                        </td>\n                                        <td>{teacher.school_name || 'Not specified'}</td>\n                                        <td>{teacher.student_count || 0}</td>\n                                        <td>\n                                            <span className={teacher.verified ? styles.verified : styles.pending}>\n                                                {teacher.verified ? 'Verified' : 'Pending'}\n                                            </span>\n                                        </td>\n                                        <td>\n                                            <button className={styles.actionBtn}>View</button>\n                                            {!teacher.verified && (\n                                                <button className={styles.verifyBtn}>Verify</button>\n                                            )}\n                                        </td>\n                                    </tr>\n                                ))}\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            )}\n\n            {activeTab === 'resources' && (\n                <div className={styles.resourcesSection}>\n                    <div className={styles.resourcesHeader}>\n                        <h3>Downloadable Resources for Teachers</h3>\n                        <p>Curated Caribbean-focused educational materials</p>\n                    </div>\n\n                    <div className={styles.resourceGrid}>\n                        {[\n                            { title: 'Caribbean Alphabet Posters', type: 'PDF Pack', downloads: 234, age: '3-5' },\n                            { title: 'Island Counting Worksheets', type: 'Worksheet Bundle', downloads: 189, age: '4-6' },\n                            { title: 'Carnival Coloring Book', type: 'Coloring Pages', downloads: 412, age: '3-8' },\n                            { title: 'Caribbean Animals Flashcards', type: 'Flashcard Set', downloads: 156, age: '3-6' },\n                            { title: 'Folk Song Lyrics & Activities', type: 'Activity Pack', downloads: 98, age: '5-8' },\n                            { title: 'Island Nations Map Activities', type: 'Geography Pack', downloads: 203, age: '6-8' },\n                        ].map((resource, idx) => (\n                            <div key={idx} className={`glass-card ${styles.resourceCard}`}>\n                                <div className={styles.resourceIcon}><FileText size={24} /></div>\n                                <h4>{resource.title}</h4>\n                                <p className={styles.resourceType}>{resource.type}</p>\n                                <div className={styles.resourceMeta}>\n                                    <span><Download size={14} /> {resource.downloads}</span>\n                                    <span><Clock size={14} /> Ages {resource.age}</span>\n                                </div>\n                                <button className={styles.downloadBtn}>\n                                    <Download size={16} /> Download\n                                </button>\n                            </div>\n                        ))}\n                    </div>\n                </div>\n            )}\n\n            {activeTab === 'curriculum' && (\n                <div className={styles.curriculumSection}>\n                    <div className={styles.curriculumHeader}>\n                        <h3>Caribbean Early Childhood Curriculum</h3>\n                        <p>Aligned with regional standards for ages 3-8</p>\n                    </div>\n\n                    <div className={styles.ageGroups}>\n                        {['3-4 Years', '5-6 Years', '7-8 Years'].map((age) => (\n                            <div key={age} className={`glass-card ${styles.ageCard}`}>\n                                <h4>{age}</h4>\n                                <div className={styles.subjectList}>\n                                    {['Literacy', 'Numeracy', 'Science', 'Social Studies', 'Art', 'Music', 'Caribbean Culture'].map((subject) => (\n                                        <div key={subject} className={styles.subjectRow}>\n                                            <span>{subject}</span>\n                                            <div className={styles.progressBar}>\n                                                <div className={styles.progressFill} style={{ width: `${Math.random() * 60 + 20}%` }} />\n                                            </div>\n                                        </div>\n                                    ))}\n                                </div>\n                            </div>\n                        ))}\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\admin\\users\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\api\\content\\generate\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\api\\jobs\\process\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\api\\payments\\paypal\\confirm\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\api\\payments\\paypal\\webhooks\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\characters\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\checkout\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\library\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\login\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Shield' is defined but never used.","line":5,"column":56,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":62,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Shield"},"fix":{"range":[158,166],"text":""},"desc":"Remove unused variable \"Shield\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport Navbar from '@/components/Navbar';\r\nimport Pricing from '@/components/Pricing';\r\nimport { Sparkles, BookOpen, Music, Globe, ArrowRight, Shield } from 'lucide-react';\r\nimport styles from './page.module.css';\r\nimport Link from 'next/link';\r\n\r\nexport default function Home() {\r\n  return (\r\n    <div className={styles.page}>\r\n      <Navbar />\r\n\r\n      {/* Hero Section */}\r\n      <section className={styles.hero}>\r\n        <div className={styles.heroGlow} />\r\n        <div className={styles.container}>\r\n          <div className={styles.heroContent}>\r\n            <div className={styles.badge}>\r\n              <Sparkles size={16} />\r\n              <span>Version 3.1.0 Now Live</span>\r\n            </div>\r\n            <h1 className={styles.title}>\r\n              Raise Proud, <span className=\"gradient-text\">Confident</span> Caribbean Kids.\r\n            </h1>\r\n            <p className={styles.subtitle}>\r\n              The monthly mail club that delivers personalized letters, cultural activities, and AI-powered stories to help your child love their roots.\r\n            </p>\r\n            <div className={styles.ctas}>\r\n              <Link href=\"/signup\" className={styles.primaryCTA}>\r\n                Start Your child&apos;s Adventure <ArrowRight size={20} />\r\n              </Link>\r\n              <Link href=\"/#pricing\" className={styles.secondaryCTA}>\r\n                View Plans\r\n              </Link>\r\n            </div>\r\n          </div>\r\n\r\n          <div className={styles.heroVisual}>\r\n            {/* Abstract visual representative of the app */}\r\n            <div className={styles.floatingCard}>\r\n              <BookOpen size={40} className={styles.icon1} />\r\n              <div className={styles.cardInfo}>\r\n                <strong>Personalized Letters</strong>\r\n                <span>Tailored Stories</span>\r\n              </div>\r\n            </div>\r\n            <div className={`${styles.floatingCard} ${styles.card2}`}>\r\n              <Music size={40} className={styles.icon2} />\r\n              <div className={styles.cardInfo}>\r\n                <strong>Island Nursery Songs</strong>\r\n                <span>Cultural Rhythm</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Features Grid */}\r\n      <section id=\"how-it-works\" className={styles.featuresSection}>\r\n        <div className={styles.container}>\r\n          <div className={styles.sectionHeader}>\r\n            <h2 className={styles.sectionTitle}>How It Works</h2>\r\n            <p className={styles.sectionSubtitle}>Simple steps to bring the islands home.</p>\r\n          </div>\r\n\r\n          <div className={styles.featuresGrid}>\r\n            <div className={`${styles.featureCard} glass-card`}>\r\n              <div className={styles.featureIcon}><BookOpen /></div>\r\n              <h3>Choose Age Path</h3>\r\n              <p>Pick Mini Legends (4-5) or Big Legends (6-8) to match your child&apos;s stage.</p>\r\n            </div>\r\n            <div className={`${styles.featureCard} glass-card`}>\r\n              <div className={styles.featureIcon}><Globe /></div>\r\n              <h3>Monthly Mail</h3>\r\n              <p>Personalized letters and cultural flashcards arrive in your mailbox.</p>\r\n            </div>\r\n            <div className={`${styles.featureCard} glass-card`}>\r\n              <div className={styles.featureIcon}><Sparkles /></div>\r\n              <h3>Digital Portal</h3>\r\n              <p>Unlock stories, songs, and missions in a safe digital environment.</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      <Pricing />\r\n\r\n      {/* Footer */}\r\n      <footer className={styles.footer}>\r\n        <div className={styles.container}>\r\n          <div className={styles.footerGrid}>\r\n            <div className={styles.footerBrand}>\r\n              <span className=\"gradient-text\">Likkle Legends</span>\r\n              <p>Bringing Caribbean culture, pride, and emotional literacy to children everywhere.</p>\r\n            </div>\r\n            <div className={styles.footerLinks}>\r\n              <h3>Platform</h3>\r\n              <Link href=\"/pricing\">Pricing</Link>\r\n              <Link href=\"/admin\">Dashboard</Link>\r\n            </div>\r\n            <div className={styles.footerLinks}>\r\n              <h3>Legal</h3>\r\n              <Link href=\"/privacy\">Privacy</Link>\r\n              <Link href=\"/terms\">Terms</Link>\r\n            </div>\r\n          </div>\r\n          <div className={styles.copyright}>\r\n            <p>┬⌐ 2026 Likkle Legends. Handcrafted for the diaspora.</p>\r\n          </div>\r\n        </div>\r\n      </footer>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\pricing\\page.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":27,"column":26,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[984,1026],"text":"We&apos;re here to help you start your journey."},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[984,1026],"text":"We&lsquo;re here to help you start your journey."},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[984,1026],"text":"We&#39;re here to help you start your journey."},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[984,1026],"text":"We&rsquo;re here to help you start your journey."},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport Navbar from '@/components/Navbar';\r\nimport Pricing from '@/components/Pricing';\r\nimport styles from './pricing.module.css';\r\nimport Link from 'next/link';\r\n\r\nexport default function PricingPage() {\r\n    return (\r\n        <div className={styles.page}>\r\n            <Navbar />\r\n\r\n            <header className={styles.header}>\r\n                <div className={styles.container}>\r\n                    <h1 className={styles.title}>Simple, Transparent <span className=\"gradient-text\">Pricing</span></h1>\r\n                    <p className={styles.subtitle}>Choose the legend track that fits your family best. All plans include Caribbean cultural heritage and pride.</p>\r\n                </div>\r\n            </header>\r\n\r\n            <main>\r\n                <Pricing />\r\n            </main>\r\n\r\n            <section className={styles.faqPreview}>\r\n                <div className={styles.container}>\r\n                    <h2>Have Questions?</h2>\r\n                    <p>We're here to help you start your journey.</p>\r\n                    <Link href=\"/contact\" className={styles.contactBtn}>Contact Support</Link>\r\n                </div>\r\n            </section>\r\n\r\n            <footer className={styles.footer}>\r\n                <div className={styles.container}>\r\n                    <div className={styles.footerGrid}>\r\n                        <div className={styles.footerBrand}>\r\n                            <span className=\"gradient-text\">Likkle Legends</span>\r\n                            <p>Bringing Caribbean culture, pride, and emotional literacy to children everywhere.</p>\r\n                        </div>\r\n                        <div className={styles.footerLinks}>\r\n                            <h3>Platform</h3>\r\n                            <Link href=\"/\">Home</Link>\r\n                            <Link href=\"/admin\">Dashboard</Link>\r\n                        </div>\r\n                        <div className={styles.footerLinks}>\r\n                            <h3>Legal</h3>\r\n                            <Link href=\"/privacy\">Privacy</Link>\r\n                            <Link href=\"/terms\">Terms</Link>\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.copyright}>\r\n                        <p>┬⌐ 2026 Likkle Legends. Handcrafted for the diaspora.</p>\r\n                    </div>\r\n                </div>\r\n            </footer>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\privacy\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\signup\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'data' is assigned a value but never used.","line":25,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { createClient } from '@/lib/supabase/client';\r\nimport { useRouter } from 'next/navigation';\r\nimport Link from 'next/link';\r\nimport { ArrowLeft, Loader2, Mail, Lock, User } from 'lucide-react';\r\nimport styles from './Auth.module.css';\r\n\r\nconst supabase = createClient();\r\n\r\nexport default function SignupPage() {\r\n    const [email, setEmail] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [fullName, setFullName] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const router = useRouter();\r\n\r\n    const handleSignup = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setLoading(true);\r\n        setError(null);\r\n\r\n        const { data, error: authError } = await supabase.auth.signUp({\r\n            email,\r\n            password,\r\n            options: {\r\n                data: {\r\n                    full_name: fullName,\r\n                }\r\n            }\r\n        });\r\n\r\n        if (authError) {\r\n            setError(authError.message);\r\n            setLoading(false);\r\n        } else {\r\n            // Create user profile in 'users' table if needed, or rely on triggers\r\n            router.push('/admin');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={styles.page}>\r\n            <div className={styles.container}>\r\n                <Link href=\"/\" className={styles.backLink}>\r\n                    <ArrowLeft size={18} />\r\n                    <span>Back to Home</span>\r\n                </Link>\r\n\r\n                <div className={`${styles.card} glass-card`}>\r\n                    <h1 className={styles.title}>Start Your <span className=\"gradient-text\">Legend</span></h1>\r\n                    <p className={styles.subtitle}>Join thousands of Caribbean families building identity.</p>\r\n\r\n                    <form onSubmit={handleSignup} className={styles.form}>\r\n                        {error && <div className={styles.error}>{error}</div>}\r\n\r\n                        <div className={styles.inputGroup}>\r\n                            <label><User size={16} /> Full Name</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={fullName}\r\n                                onChange={(e) => setFullName(e.target.value)}\r\n                                placeholder=\"Paulette Williams\"\r\n                                required\r\n                            />\r\n                        </div>\r\n\r\n                        <div className={styles.inputGroup}>\r\n                            <label><Mail size={16} /> Email Address</label>\r\n                            <input\r\n                                type=\"email\"\r\n                                value={email}\r\n                                onChange={(e) => setEmail(e.target.value)}\r\n                                placeholder=\"name@example.com\"\r\n                                required\r\n                            />\r\n                        </div>\r\n\r\n                        <div className={styles.inputGroup}>\r\n                            <label><Lock size={16} /> Create Password</label>\r\n                            <input\r\n                                type=\"password\"\r\n                                value={password}\r\n                                onChange={(e) => setPassword(e.target.value)}\r\n                                placeholder=\"ΓÇóΓÇóΓÇóΓÇóΓÇóΓÇóΓÇóΓÇó\"\r\n                                required\r\n                            />\r\n                        </div>\r\n\r\n                        <button type=\"submit\" className={styles.submitBtn} disabled={loading}>\r\n                            {loading ? <Loader2 className=\"animate-spin\" /> : 'Create Account'}\r\n                        </button>\r\n                    </form>\r\n\r\n                    <p className={styles.footerText}>\r\n                        Already have an account? <Link href=\"/login\">Sign in</Link>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\app\\terms\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\components\\CheckoutFlow.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ShieldCheck' is defined but never used.","line":6,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":28,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ShieldCheck"},"fix":{"range":[188,201],"text":""},"desc":"Remove unused variable \"ShieldCheck\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Gift' is defined but never used.","line":6,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":44,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Gift"},"fix":{"range":[211,217],"text":""},"desc":"Remove unused variable \"Gift\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used.","line":6,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":57,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AlertCircle"},"fix":{"range":[217,230],"text":""},"desc":"Remove unused variable \"AlertCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":6,"column":68,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":77,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[239,250],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'supabase' is assigned a value but never used.","line":15,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isProcessing' is assigned a value but never used.","line":29,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setPaymentBillingCycle' is assigned a value but never used.","line":30,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":55}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { PayPalScriptProvider, PayPalButtons } from '@paypal/react-paypal-js';\r\nimport Link from 'next/link';\r\nimport { Check, ShieldCheck, Sparkles, Gift, AlertCircle, Loader2, ArrowLeft } from 'lucide-react';\r\nimport { SUBSCRIPTION_PLANS, getLocalizedPrice, SubscriptionTier } from '@/lib/paypal';\r\nimport { detectCountry, GeoInfo } from '@/lib/geo-routing';\r\nimport { createClient } from '@/lib/supabase/client';\r\nimport { useUser } from '@/components/UserContext';\r\nimport { trackEvent } from '@/lib/analytics';\r\nimport { queueAbandonedCheckout, cancelAbandonedCheckout } from '@/lib/services/email-triggers';\r\nimport styles from './CheckoutFlow.module.css';\r\n\r\nconst supabase = createClient();\r\n\r\ninterface CheckoutFlowProps {\r\n    selectedTier?: SubscriptionTier;\r\n    initialBillingCycle?: 'month' | 'year';\r\n    initialChildName?: string;\r\n    onSuccess?: (subscriptionId: string) => void;\r\n    onError?: (error: unknown) => void;\r\n}\r\n\r\nexport default function CheckoutFlow({ selectedTier, initialBillingCycle, initialChildName, onSuccess, onError }: CheckoutFlowProps) {\r\n    const [step, setStep] = useState<'plan' | 'shipping' | 'payment' | 'success'>('plan');\r\n    const [activeTier, setActiveTier] = useState<SubscriptionTier>(selectedTier || 'plan_digital_legends');\r\n    const [geoInfo, setGeoInfo] = useState<GeoInfo | null>(null);\r\n    const [isProcessing, setIsProcessing] = useState(false);\r\n    const [paymentBillingCycle, setPaymentBillingCycle] = useState<'month' | 'year'>(initialBillingCycle || 'month');\r\n    const [shippingData, setShippingData] = useState({\r\n        name: initialChildName || '',\r\n        line1: '',\r\n        line2: '',\r\n        city: '',\r\n        state: '',\r\n        postalCode: '',\r\n        country: '',\r\n    });\r\n\r\n    const { user } = useUser();\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n        detectCountry().then(setGeoInfo);\r\n    }, []);\r\n\r\n    if (!mounted) return <div className={styles.loaderWrap}><Loader2 className=\"animate-spin\" size={32} /></div>;\r\n\r\n    const plan = SUBSCRIPTION_PLANS[activeTier];\r\n    const displayPrice = geoInfo\r\n        ? getLocalizedPrice(paymentBillingCycle === 'year' ? (plan.priceYearly || plan.price * 10) : plan.price, geoInfo.countryCode)\r\n        : { price: paymentBillingCycle === 'year' ? (plan.priceYearly || plan.price * 10) : plan.price, currency: 'USD', symbol: '$' };\r\n\r\n    const handlePayPalApprove = async (data: { subscriptionID?: string | null }) => {\r\n        setIsProcessing(true);\r\n        try {\r\n            const userId = user?.id;\r\n            const response = await fetch('/api/payments/paypal/confirm', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    subscriptionId: data.subscriptionID,\r\n                    tier: activeTier,\r\n                    currency: displayPrice.currency,\r\n                    billingCycle: paymentBillingCycle,\r\n                    userId\r\n                }),\r\n            });\r\n\r\n            if (!response.ok) throw new Error('Confirmation failed');\r\n\r\n            setStep('success');\r\n            if (user?.email) await cancelAbandonedCheckout(user.email);\r\n            trackEvent('purchase', { value: displayPrice.price, currency: displayPrice.currency });\r\n            onSuccess?.(data.subscriptionID || '');\r\n        } catch (error) {\r\n            console.error(error);\r\n            alert('Confirmation failed. Please contact support.');\r\n            onError?.(error);\r\n        } finally {\r\n            setIsProcessing(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={styles.wrapper}>\r\n            {step !== 'success' && (\r\n                <div className={styles.stepper}>\r\n                    {['plan', 'shipping', 'payment'].map((s, i) => (\r\n                        <div key={s} className={`${styles.step} ${step === s ? styles.active : ''}`}>\r\n                            <div className={styles.stepCircle}>{i + 1}</div>\r\n                            <span className={styles.stepLabel}>{s}</span>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n\r\n            {step === 'plan' && (\r\n                <div className={styles.stepContent}>\r\n                    <h2 className={styles.stepTitle}>Choose Your Plan</h2>\r\n                    <div className={styles.planGrid}>\r\n                        {(Object.entries(SUBSCRIPTION_PLANS) as [SubscriptionTier, typeof plan][]).map(([id, p]) => (\r\n                            <button\r\n                                key={id}\r\n                                onClick={() => setActiveTier(id)}\r\n                                className={`${styles.planCard} ${activeTier === id ? styles.selected : ''}`}\r\n                            >\r\n                                <h3>{p.name}</h3>\r\n                                <p className={styles.pPrice}>{displayPrice.symbol}{p.price}/mo</p>\r\n                                <ul className={styles.pFeatures}>\r\n                                    {p.features.slice(0, 3).map((f, idx) => <li key={idx}><Check size={14} /> {f}</li>)}\r\n                                </ul>\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                    <button\r\n                        className={styles.nextBtn}\r\n                        onClick={() => {\r\n                            setStep('shipping');\r\n                            if (user?.email) queueAbandonedCheckout(user.email, user.first_name);\r\n                        }}\r\n                    >\r\n                        Continue &rarr;\r\n                    </button>\r\n                </div>\r\n            )}\r\n\r\n            {step === 'shipping' && (\r\n                <div className={styles.stepContent}>\r\n                    <h2 className={styles.stepTitle}>Shipping Details</h2>\r\n                    <div className={styles.form}>\r\n                        <input placeholder=\"Full Name\" value={shippingData.name} onChange={e => setShippingData({ ...shippingData, name: e.target.value })} className={styles.input} />\r\n                        <input placeholder=\"Address Line 1\" value={shippingData.line1} onChange={e => setShippingData({ ...shippingData, line1: e.target.value })} className={styles.input} />\r\n                        <div className={styles.row}>\r\n                            <input placeholder=\"City\" value={shippingData.city} onChange={e => setShippingData({ ...shippingData, city: e.target.value })} className={styles.input} />\r\n                            <input placeholder=\"Postcode\" value={shippingData.postalCode} onChange={e => setShippingData({ ...shippingData, postalCode: e.target.value })} className={styles.input} />\r\n                        </div>\r\n                        <input placeholder=\"Country\" value={shippingData.country} onChange={e => setShippingData({ ...shippingData, country: e.target.value })} className={styles.input} />\r\n                    </div>\r\n                    <div className={styles.actions}>\r\n                        <button onClick={() => setStep('plan')} className={styles.backBtn}>Back</button>\r\n                        <button onClick={() => setStep('payment')} className={styles.nextBtn}>Payment &rarr;</button>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {step === 'payment' && (\r\n                <div className={styles.stepContent}>\r\n                    <h2 className={styles.stepTitle}>Secure Payment</h2>\r\n                    <div className={styles.summaryCard}>\r\n                        <div className={styles.summaryRow}>\r\n                            <span>{plan.name}</span>\r\n                            <span>{displayPrice.symbol}{displayPrice.price}</span>\r\n                        </div>\r\n                        <hr className={styles.divider} />\r\n                        <div className={`${styles.summaryRow} ${styles.total}`}>\r\n                            <span>Total</span>\r\n                            <span>{displayPrice.symbol}{displayPrice.price}</span>\r\n                        </div>\r\n                    </div>\r\n                    <PayPalScriptProvider options={{ clientId: process.env.NEXT_PUBLIC_PAYPAL_CLIENT_ID || '', vault: true, intent: 'subscription', currency: displayPrice.currency }}>\r\n                        <PayPalButtons\r\n                            style={{ layout: 'vertical', color: 'gold' }}\r\n                            createSubscription={(data, actions) => actions.subscription.create({\r\n                                plan_id: paymentBillingCycle === 'year' ? (plan.paypalPlanIdYearly || '') : plan.paypalPlanId,\r\n                                custom_id: user?.id\r\n                            })}\r\n                            onApprove={handlePayPalApprove}\r\n                        />\r\n                    </PayPalScriptProvider>\r\n                </div>\r\n            )}\r\n\r\n            {step === 'success' && (\r\n                <div className={styles.success}>\r\n                    <Sparkles size={64} className={styles.successIcon} />\r\n                    <h2>You&apos;re In! ≡ƒÄë</h2>\r\n                    <p>Welcome to the Likkle Legends family.</p>\r\n                    <Link href=\"/admin\" className={styles.nextBtn}>Enter Dashboard</Link>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\components\\FileUpload.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Upload' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Upload"},"fix":{"range":[79,86],"text":""},"desc":"Remove unused variable \"Upload\"."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":106,"column":25,"nodeType":"JSXOpeningElement","endLine":106,"endColumn":95}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useRef, useCallback } from 'react';\nimport { Upload, X, CheckCircle, Loader2, ImageIcon, FileAudio, File } from 'lucide-react';\nimport { uploadFile, StorageBucket } from '@/lib/storage';\nimport styles from './FileUpload.module.css';\n\ninterface FileUploadProps {\n    bucket: StorageBucket;\n    path: string;\n    accept?: string;\n    maxSizeMB?: number;\n    onUploadComplete?: (url: string) => void;\n    onError?: (error: string) => void;\n    label?: string;\n    preview?: boolean;\n}\n\nexport default function FileUpload({\n    bucket,\n    path,\n    accept = 'image/*',\n    maxSizeMB = 5,\n    onUploadComplete,\n    onError,\n    label = 'Upload File',\n    preview = true\n}: FileUploadProps) {\n    const [uploading, setUploading] = useState(false);\n    const [uploaded, setUploaded] = useState(false);\n    const [previewUrl, setPreviewUrl] = useState<string | null>(null);\n    const [dragOver, setDragOver] = useState(false);\n    const inputRef = useRef<HTMLInputElement>(null);\n\n    const handleFile = useCallback(async (file: File) => {\n        // Validate file size\n        if (file.size > maxSizeMB * 1024 * 1024) {\n            onError?.(`File too large. Maximum size is ${maxSizeMB}MB`);\n            return;\n        }\n\n        setUploading(true);\n        setUploaded(false);\n\n        // Show preview for images\n        if (preview && file.type.startsWith('image/')) {\n            const reader = new FileReader();\n            reader.onload = (e) => setPreviewUrl(e.target?.result as string);\n            reader.readAsDataURL(file);\n        }\n\n        const result = await uploadFile(bucket, file, path);\n\n        setUploading(false);\n\n        if (result.success && result.url) {\n            setUploaded(true);\n            onUploadComplete?.(result.url);\n        } else {\n            setPreviewUrl(null);\n            onError?.(result.error || 'Upload failed');\n        }\n    }, [bucket, path, maxSizeMB, onUploadComplete, onError, preview]);\n\n    const handleDrop = useCallback((e: React.DragEvent) => {\n        e.preventDefault();\n        setDragOver(false);\n        const file = e.dataTransfer.files[0];\n        if (file) handleFile(file);\n    }, [handleFile]);\n\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const file = e.target.files?.[0];\n        if (file) handleFile(file);\n    };\n\n    const clearUpload = () => {\n        setPreviewUrl(null);\n        setUploaded(false);\n        if (inputRef.current) inputRef.current.value = '';\n    };\n\n    const getIcon = () => {\n        if (accept.includes('audio')) return <FileAudio size={24} />;\n        if (accept.includes('image')) return <ImageIcon size={24} />;\n        return <File size={24} />;\n    };\n\n    return (\n        <div className={styles.container}>\n            <label className={styles.label}>{label}</label>\n            <div\n                className={`${styles.dropzone} ${dragOver ? styles.dragOver : ''} ${uploaded ? styles.uploaded : ''}`}\n                onDragOver={(e) => { e.preventDefault(); setDragOver(true); }}\n                onDragLeave={() => setDragOver(false)}\n                onDrop={handleDrop}\n                onClick={() => inputRef.current?.click()}\n            >\n                {uploading ? (\n                    <div className={styles.uploading}>\n                        <Loader2 className=\"animate-spin\" size={32} />\n                        <span>Uploading...</span>\n                    </div>\n                ) : uploaded && previewUrl ? (\n                    <div className={styles.preview}>\n                        <img src={previewUrl} alt=\"Preview\" className={styles.previewImage} />\n                        <button className={styles.clearBtn} onClick={(e) => { e.stopPropagation(); clearUpload(); }}>\n                            <X size={16} />\n                        </button>\n                        <CheckCircle className={styles.checkIcon} size={20} />\n                    </div>\n                ) : uploaded ? (\n                    <div className={styles.success}>\n                        <CheckCircle size={32} />\n                        <span>File uploaded!</span>\n                        <button className={styles.clearBtn} onClick={(e) => { e.stopPropagation(); clearUpload(); }}>\n                            <X size={16} />\n                        </button>\n                    </div>\n                ) : (\n                    <div className={styles.placeholder}>\n                        {getIcon()}\n                        <span>Drop file here or click to browse</span>\n                        <small>Max {maxSizeMB}MB</small>\n                    </div>\n                )}\n                <input\n                    ref={inputRef}\n                    type=\"file\"\n                    accept={accept}\n                    onChange={handleChange}\n                    className={styles.hiddenInput}\n                />\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\components\\Navbar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used.","line":6,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":23,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"User"},"fix":{"range":[160,166],"text":""},"desc":"Remove unused variable \"User\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used.","line":10,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport Link from 'next/link';\r\nimport { useUser } from '@/components/UserContext';\r\nimport styles from './Navbar.module.css';\r\nimport { Menu, X, User } from 'lucide-react';\r\nimport { useState } from 'react';\r\n\r\nexport default function Navbar() {\r\n    const { user, isAuthenticated, logout } = useUser();\r\n    const [isOpen, setIsOpen] = useState(false);\r\n\r\n    return (\r\n        <nav className={styles.navbar}>\r\n            <div className={styles.container}>\r\n                <Link href=\"/\" className={styles.logo}>\r\n                    <span className=\"gradient-text\">Likkle Legends</span>\r\n                </Link>\r\n\r\n                <div className={styles.desktopNav}>\r\n                    <Link href=\"/#how-it-works\">How It Works</Link>\r\n                    <Link href=\"/characters\">Characters</Link>\r\n                    <Link href=\"/pricing\">Pricing</Link>\r\n\r\n                    {isAuthenticated ? (\r\n                        <div className={styles.userSection}>\r\n                            <Link href=\"/admin\" className={styles.adminBtn}>Dashboard</Link>\r\n                            <button onClick={logout} className={styles.logoutBtn}>Logout</button>\r\n                        </div>\r\n                    ) : (\r\n                        <div className={styles.authButtons}>\r\n                            <Link href=\"/login\" className={styles.loginBtn}>Login</Link>\r\n                            <Link href=\"/signup\" className={styles.signupBtn}>Get Started</Link>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                <button className={styles.mobileToggle} onClick={() => setIsOpen(!isOpen)}>\r\n                    {isOpen ? <X /> : <Menu />}\r\n                </button>\r\n            </div>\r\n\r\n            {isOpen && (\r\n                <div className={styles.mobileNav}>\r\n                    <Link href=\"/#how-it-works\" onClick={() => setIsOpen(false)}>How It Works</Link>\r\n                    <Link href=\"/characters\" onClick={() => setIsOpen(false)}>Characters</Link>\r\n                    <Link href=\"/pricing\" onClick={() => setIsOpen(false)}>Pricing</Link>\r\n                    {isAuthenticated ? (\r\n                        <>\r\n                            <Link href=\"/admin\" onClick={() => setIsOpen(false)}>Dashboard</Link>\r\n                            <button onClick={() => { logout(); setIsOpen(false); }}>Logout</button>\r\n                        </>\r\n                    ) : (\r\n                        <>\r\n                            <Link href=\"/login\" onClick={() => setIsOpen(false)}>Login</Link>\r\n                            <Link href=\"/signup\" onClick={() => setIsOpen(false)}>Get Started</Link>\r\n                        </>\r\n                    )}\r\n                </div>\r\n            )}\r\n        </nav>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\components\\Pricing.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sparkles' is defined but never used.","line":5,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":25,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Sparkles"},"fix":{"range":[108,118],"text":""},"desc":"Remove unused variable \"Sparkles\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Star' is defined but never used.","line":5,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":44,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Star"},"fix":{"range":[131,137],"text":""},"desc":"Remove unused variable \"Star\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport Link from 'next/link';\r\nimport { Check, Sparkles, Gift, Crown, Star } from 'lucide-react';\r\nimport { SUBSCRIPTION_PLANS, getLocalizedPrice, SubscriptionTier } from '@/lib/paypal';\r\nimport { detectCountry, GeoInfo } from '@/lib/geo-routing';\r\nimport { siteContent } from '@/lib/content';\r\nimport styles from './Pricing.module.css';\r\n\r\ninterface PricingProps {\r\n    content?: typeof siteContent.pricing;\r\n}\r\n\r\nexport default function Pricing({ content }: PricingProps) {\r\n    const pricing = content || siteContent.pricing;\r\n    const [geoInfo, setGeoInfo] = useState<GeoInfo | null>(null);\r\n    const [billingCycle, setBillingCycle] = useState<'monthly' | 'annual'>('monthly');\r\n\r\n    useEffect(() => {\r\n        detectCountry().then(setGeoInfo);\r\n    }, []);\r\n\r\n    const getPlanIcon = (id: string) => {\r\n        switch (id) {\r\n            case 'plan_free_forever': return '≡ƒî▒';\r\n            case 'plan_digital_legends': return '≡ƒô▒';\r\n            case 'plan_mail_intro': return '≡ƒô¼';\r\n            case 'plan_legends_plus': return 'Γ¡É';\r\n            case 'plan_family_legacy': return '≡ƒææ';\r\n            default: return 'Γ£¿';\r\n        }\r\n    };\r\n\r\n    return (\r\n        <section id=\"pricing\" className={styles.section}>\r\n            <div className={styles.container}>\r\n                <div className={styles.header}>\r\n                    <span className={styles.badge}>\r\n                        <Gift size={16} />\r\n                        Pricing & Plans\r\n                    </span>\r\n                    <h2 className={styles.title}>\r\n                        Choose Your <span className=\"gradient-text\">Adventure</span>\r\n                    </h2>\r\n                    <p className={styles.subtitle}>\r\n                        {pricing.subtitle}\r\n                    </p>\r\n                </div>\r\n\r\n                <div className={styles.toggleRow}>\r\n                    <div className={styles.toggleGroup}>\r\n                        <button\r\n                            onClick={() => setBillingCycle('monthly')}\r\n                            className={`${styles.toggleBtn} ${billingCycle === 'monthly' ? styles.active : ''}`}\r\n                        >\r\n                            Monthly\r\n                        </button>\r\n                        <button\r\n                            onClick={() => setBillingCycle('annual')}\r\n                            className={`${styles.toggleBtn} ${billingCycle === 'annual' ? styles.active : ''}`}\r\n                        >\r\n                            Annual\r\n                            <span className={styles.saveBadge}>Save 20%</span>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className={styles.grid}>\r\n                    {(Object.entries(SUBSCRIPTION_PLANS) as [SubscriptionTier, typeof SUBSCRIPTION_PLANS.plan_free_forever][]).map(([id, plan]) => {\r\n                        const isFree = id === 'plan_free_forever';\r\n                        const priceInfo = isFree\r\n                            ? { price: 0, symbol: '', currency: 'USD' }\r\n                            : geoInfo\r\n                                ? getLocalizedPrice(plan.price, geoInfo.countryCode)\r\n                                : { price: plan.price, symbol: '$', currency: 'USD' };\r\n\r\n                        return (\r\n                            <div key={id} className={`${styles.card} glass-card`}>\r\n                                <div className={styles.cardHeader}>\r\n                                    <div className={styles.planIcon}>{getPlanIcon(id)}</div>\r\n                                    <h3 className={styles.planName}>{plan.name}</h3>\r\n                                    <p className={styles.planDesc}>{plan.description}</p>\r\n                                </div>\r\n\r\n                                <div className={styles.priceContainer}>\r\n                                    {isFree ? (\r\n                                        <span className={styles.price}>Free</span>\r\n                                    ) : (\r\n                                        <>\r\n                                            <span className={styles.price}>\r\n                                                {priceInfo.symbol}{priceInfo.price}\r\n                                            </span>\r\n                                            <span className={styles.interval}>/mo</span>\r\n                                        </>\r\n                                    )}\r\n                                </div>\r\n\r\n                                <ul className={styles.featureList}>\r\n                                    {plan.features.map((feature, i) => (\r\n                                        <li key={i} className={styles.featureItem}>\r\n                                            <Check size={14} className={styles.checkIcon} />\r\n                                            <span>{feature}</span>\r\n                                        </li>\r\n                                    ))}\r\n                                </ul>\r\n\r\n                                <Link\r\n                                    href={`/checkout?plan=${id}&cycle=${billingCycle}`}\r\n                                    className={`${styles.cta} ${id === 'plan_digital_legends' ? styles.primary : ''}`}\r\n                                >\r\n                                    {isFree ? 'Start Free' : 'Choose Plan'}\r\n                                </Link>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n\r\n                <div className={styles.footerCTA}>\r\n                    <Crown size={32} className={styles.crown} />\r\n                    <h3>{pricing.educator_block.title}</h3>\r\n                    <p>{pricing.educator_block.description}</p>\r\n                    <Link href={pricing.educator_block.cta.href} className={styles.educatorBtn}>\r\n                        {pricing.educator_block.cta.label}\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n        </section>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\components\\ProcessJobButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\components\\Sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\components\\UserContext.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\components\\UserContext.tsx:75:14\n  73 |         \n  74 |         // Use void to handle the promise without awaiting\n> 75 |         void refreshUser();\n     |              ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  76 |     }, [refreshUser]);\n  77 |\n  78 |     const logout = useCallback(async () => {","line":75,"column":14,"nodeType":null,"endLine":75,"endColumn":25}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { createContext, useContext, useState, useEffect, ReactNode, useCallback, useRef } from 'react';\nimport { createClient } from '@/lib/supabase/client';\n\nconst supabase = createClient();\n\ninterface Subscription {\n    plan_id: string;\n    status: string;\n}\n\ninterface ProfileWithSubscriptions {\n    id: string;\n    first_name: string;\n    email: string;\n    subscriptions?: Subscription[];\n}\n\ninterface Profile {\n    id: string;\n    first_name: string;\n    email: string;\n    subscription_tier: string;\n    subscription_status: string;\n}\n\ninterface UserContextType {\n    user: Profile | null;\n    isLoading: boolean;\n    isAuthenticated: boolean;\n    refreshUser: () => Promise<void>;\n    logout: () => Promise<void>;\n}\n\nconst UserContext = createContext<UserContextType | undefined>(undefined);\n\nexport function UserProvider({ children }: { children: ReactNode }) {\n    const [user, setUser] = useState<Profile | null>(null);\n    const [isLoading, setIsLoading] = useState(true);\n    const initialized = useRef(false);\n\n    const refreshUser = useCallback(async () => {\n        const { data: { session } } = await supabase.auth.getSession();\n        if (!session?.user) {\n            setUser(null);\n            setIsLoading(false);\n            return;\n        }\n\n        const { data: profile } = await supabase\n            .from('users')\n            .select('*, subscriptions(plan_id, status)')\n            .eq('id', session.user.id)\n            .single();\n\n        if (profile) {\n            const typedProfile = profile as ProfileWithSubscriptions;\n            const { subscriptions, ...userData } = typedProfile;\n            const latestSub = subscriptions?.[0];\n            setUser({\n                ...userData,\n                subscription_tier: latestSub?.plan_id || 'free',\n                subscription_status: latestSub?.status || 'inactive'\n            });\n        }\n        setIsLoading(false);\n    }, []);\n\n    useEffect(() => {\n        if (initialized.current) return;\n        initialized.current = true;\n        \n        // Use void to handle the promise without awaiting\n        void refreshUser();\n    }, [refreshUser]);\n\n    const logout = useCallback(async () => {\n        await supabase.auth.signOut();\n        setUser(null);\n    }, []);\n\n    const value = {\n        user,\n        isLoading,\n        isAuthenticated: !!user,\n        refreshUser,\n        logout\n    };\n\n    return (\n        <UserContext.Provider value={value}>\n            {children}\n        </UserContext.Provider>\n    );\n}\n\nexport function useUser() {\n    const context = useContext(UserContext);\n    if (context === undefined) {\n        throw new Error('useUser must be used within a UserProvider');\n    }\n    return context;\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\lib\\analytics.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":4,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":4,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[146,149],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[146,149],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[280,283],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[280,283],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[321,324],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[321,324],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":12,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":19}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Defensive analytics wrapper to handle blocked tracking scripts\r\n */\r\nexport const trackEvent = (eventName: string, params: Record<string, any> = {}) => {\r\n    try {\r\n        if (typeof window !== 'undefined') {\r\n            // Google Analytics\r\n            if ((window as any).gtag) {\r\n                (window as any).gtag('event', eventName, params);\r\n            }\r\n        }\r\n    } catch (error) {\r\n        console.warn('Analytics event blocked or failed:', eventName);\r\n    }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\lib\\content-agent.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\lib\\content.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\lib\\gemini.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\lib\\geo-routing.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\lib\\paypal.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\lib\\services\\email-triggers.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'planName' is assigned a value but never used.","line":8,"column":75,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":83},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'name' is defined but never used.","line":18,"column":68,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":72},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'tier' is defined but never used.","line":18,"column":82,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":86},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'childName' is defined but never used.","line":18,"column":96,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":105}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use server\";\r\n\r\n/**\r\n * EMAIL TRIGGER FUNCTIONS\r\n * Stubs for v3 - prevents errors until email_queue table is finalized\r\n */\r\n\r\nexport async function queueAbandonedCheckout(email: string, name: string, planName: string = 'Legends Plus') {\r\n    console.log(`[STUB] Queue abandoned checkout for ${email}`);\r\n    return { success: true };\r\n}\r\n\r\nexport async function cancelAbandonedCheckout(email: string) {\r\n    console.log(`[STUB] Cancel abandoned checkout for ${email}`);\r\n    return { success: true };\r\n}\r\n\r\nexport async function queueSubscriptionConfirmation(email: string, name: string, tier: string, childName?: string) {\r\n    console.log(`[STUB] Queue subscription confirmation for ${email}`);\r\n    return { success: true };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\lib\\storage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\lib\\supabase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\lib\\supabase\\client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\lib\\supabase\\middleware.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'options' is defined but never used.","line":26,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":65}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createServerClient } from '@supabase/ssr'\r\nimport { NextResponse, type NextRequest } from 'next/server'\r\n\r\nexport async function updateSession(request: NextRequest) {\r\n    let response = NextResponse.next({\r\n        request: {\r\n            headers: request.headers,\r\n        },\r\n    })\r\n\r\n    const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\n    const supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\n    const supabase = createServerClient(\r\n        supabaseUrl,\r\n        supabaseKey,\r\n        {\r\n            cookieOptions: {\r\n                name: 'sb-likkle-auth',\r\n            },\r\n            cookies: {\r\n                getAll() {\r\n                    return request.cookies.getAll()\r\n                },\r\n                setAll(cookiesToSet) {\r\n                    cookiesToSet.forEach(({ name, value, options }) =>\r\n                        request.cookies.set(name, value)\r\n                    )\r\n                    response = NextResponse.next({\r\n                        request,\r\n                    })\r\n                    cookiesToSet.forEach(({ name, value, options }) =>\r\n                        response.cookies.set(name, value, options)\r\n                    )\r\n                },\r\n            },\r\n        }\r\n    )\r\n\r\n    // refresh the session\r\n    const { data: { user } } = await supabase.auth.getUser();\r\n\r\n    // Protected routes logic\r\n    const isAdmin = request.nextUrl.pathname.startsWith('/admin');\r\n\r\n    if (isAdmin && !user) {\r\n        return NextResponse.redirect(new URL('/login', request.url));\r\n    }\r\n\r\n    return response\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\src\\middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\tools\\apply_schema.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":1,"column":1,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":1,"endColumn":18},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":20,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":33},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":3,"column":12,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":3,"endColumn":25},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":4,"column":14,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":4,"endColumn":29}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"require('dotenv').config({ path: '.env.local' });\r\nconst { Client } = require('pg');\r\nconst fs = require('fs');\r\nconst path = require('path');\r\n\r\nasync function applySchema() {\r\n    const connectionString = process.env.DATABASE_URL;\r\n    if (!connectionString) {\r\n        console.error('DATABASE_URL is missing in .env.local');\r\n        process.exit(1);\r\n    }\r\n\r\n    const client = new Client({\r\n        connectionString: connectionString,\r\n        ssl: { rejectUnauthorized: false }\r\n    });\r\n\r\n    try {\r\n        await client.connect();\r\n        console.log('Connected to database.');\r\n\r\n        const schemaPath = path.join(__dirname, '../supabase/schema.sql');\r\n        const sql = fs.readFileSync(schemaPath, 'utf8');\r\n\r\n        console.log('Applying schema.sql...');\r\n        await client.query(sql);\r\n        console.log('Γ£à Schema applied successfully!');\r\n\r\n    } catch (err) {\r\n        console.error('Γ¥î Error applying schema:', err.message);\r\n        if (err.position) {\r\n            console.error('Error position:', err.position);\r\n            // Try to find the line number\r\n            const sql = fs.readFileSync(path.join(__dirname, '../supabase/schema.sql'), 'utf8');\r\n            const lines = sql.substring(0, parseInt(err.position)).split('\\n');\r\n            console.error(`Likely near line: ${lines.length}`);\r\n            console.error(`Context: ${lines[lines.length - 1]}`);\r\n        }\r\n    } finally {\r\n        await client.end();\r\n    }\r\n}\r\n\r\napplySchema();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\tools\\apply_views.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":1,"column":1,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":1,"endColumn":18},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":20,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":33},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":3,"column":12,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":3,"endColumn":25},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":4,"column":14,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":4,"endColumn":29}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"require('dotenv').config({ path: '.env.local' });\r\nconst { Client } = require('pg');\r\nconst fs = require('fs');\r\nconst path = require('path');\r\n\r\nasync function applyViews() {\r\n    const connectionString = process.env.DATABASE_URL;\r\n    const client = new Client({\r\n        connectionString: connectionString,\r\n        ssl: { rejectUnauthorized: false }\r\n    });\r\n\r\n    try {\r\n        await client.connect();\r\n        console.log('Connected to database.');\r\n\r\n        const sqlPath = path.join(__dirname, '../supabase/apply_views.sql');\r\n        let sql = fs.readFileSync(sqlPath, 'utf8');\r\n\r\n        // Add DROP VIEW IF EXISTS for each view\r\n        const viewNames = [\r\n            'v_admin_kpis_today',\r\n            'v_admin_ai_usage_30d',\r\n            'v_admin_lead_sources_7d',\r\n            'v_admin_subscriptions_breakdown',\r\n            'v_admin_jobs_queue',\r\n            'v_admin_contest_live_status',\r\n            'v_admin_affiliate_performance',\r\n            'v_coppa_consent_coverage',\r\n            'v_coppa_pending_requests',\r\n            'v_coppa_vendor_health',\r\n            'v_coppa_retention_enforcement',\r\n            'v_coppa_admin_access_log',\r\n            'v_coppa_incident_dashboard',\r\n            'v_coppa_metrics_today'\r\n        ];\r\n\r\n        let dropSql = viewNames.map(name => `DROP VIEW IF EXISTS ${name} CASCADE;`).join('\\n');\r\n\r\n        console.log('Applying drops and views...');\r\n        await client.query(dropSql + '\\n' + sql);\r\n        console.log('Γ£à Views applied/refreshed successfully!');\r\n\r\n    } catch (err) {\r\n        console.error('Γ¥î Error applying views:', err.message);\r\n    } finally {\r\n        await client.end();\r\n    }\r\n}\r\n\r\napplyViews();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\tools\\dry_run_schema.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":1,"column":1,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":1,"endColumn":18},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":20,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":33},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":3,"column":12,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":3,"endColumn":25},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":4,"column":14,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":4,"endColumn":29}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"require('dotenv').config({ path: '.env.local' });\r\nconst { Client } = require('pg');\r\nconst fs = require('fs');\r\nconst path = require('path');\r\n\r\nasync function dryRunSchema() {\r\n    const connectionString = process.env.DATABASE_URL;\r\n    const client = new Client({\r\n        connectionString: connectionString,\r\n        ssl: { rejectUnauthorized: false }\r\n    });\r\n\r\n    try {\r\n        await client.connect();\r\n        console.log('Connected to database.');\r\n\r\n        const schemaPath = path.join(__dirname, '../supabase/schema.sql');\r\n        const sql = fs.readFileSync(schemaPath, 'utf8');\r\n\r\n        console.log('Starting DRY RUN (Transaction with Rollback)...');\r\n\r\n        // We wrap in BEGIN and ROLLBACK\r\n        // NOTE: This will still fail if types/tables ALREADY exist.\r\n        // To truely test the syntax, we might need a blank schema or just ignore already-exists errors.\r\n\r\n        await client.query('BEGIN');\r\n\r\n        // We run the SQL. In pg, this might fail after the first error.\r\n        try {\r\n            await client.query(sql);\r\n            console.log('Γ£à SQL is syntactically correct and references are valid!');\r\n        } catch (sqlErr) {\r\n            console.error('Γ¥î SQL Validation Error:', sqlErr.message);\r\n            if (sqlErr.position) {\r\n                const lines = sql.substring(0, parseInt(sqlErr.position)).split('\\n');\r\n                console.error(`Approx. Line: ${lines.length}`);\r\n                console.error(`Context: ${lines[lines.length - 1]}`);\r\n            }\r\n        }\r\n\r\n        await client.query('ROLLBACK');\r\n        console.log('Rollback complete (Database remains unchanged).');\r\n\r\n    } catch (err) {\r\n        console.error('Fatal Connection Error:', err.message);\r\n    } finally {\r\n        await client.end();\r\n    }\r\n}\r\n\r\ndryRunSchema();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\tools\\inspect_table.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":1,"column":1,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":1,"endColumn":18},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":20,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":33}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"require('dotenv').config({ path: '.env.local' });\r\nconst { Client } = require('pg');\r\n\r\nasync function run() {\r\n    const client = new Client({ connectionString: process.env.DATABASE_URL, ssl: { rejectUnauthorized: false } });\r\n    await client.connect();\r\n    const res = await client.query(\"SELECT column_name FROM information_schema.columns WHERE table_name = 'users'\");\r\n    console.log('Columns in users:', res.rows.map(r => r.column_name));\r\n    await client.end();\r\n}\r\nrun();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\tools\\run_migration.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":1,"column":1,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":1,"endColumn":18},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":20,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":33},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":3,"column":12,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":3,"endColumn":25},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":4,"column":14,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":4,"endColumn":29}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"require('dotenv').config({ path: '.env.local' });\r\nconst { Client } = require('pg');\r\nconst fs = require('fs');\r\nconst path = require('path');\r\n\r\nasync function runMigration() {\r\n    const client = new Client({\r\n        connectionString: process.env.DATABASE_URL,\r\n        ssl: { rejectUnauthorized: false }\r\n    });\r\n\r\n    try {\r\n        await client.connect();\r\n        console.log('Connected to database.');\r\n\r\n        const sqlPath = path.join(__dirname, '../supabase/migration_v3_1.sql');\r\n        const sql = fs.readFileSync(sqlPath, 'utf8');\r\n\r\n        console.log('Executing migration_v3_1.sql...');\r\n        await client.query(sql);\r\n        console.log('Γ£à Migration executed successfully!');\r\n\r\n    } catch (err) {\r\n        console.error('Γ¥î Migration failed:', err.message);\r\n        if (err.position) {\r\n            console.error('Error position:', err.position);\r\n        }\r\n    } finally {\r\n        await client.end();\r\n    }\r\n}\r\n\r\nrunMigration();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Banjo\\.gemini\\antigravity\\scratch\\likkle-legends-v3\\tools\\test_schema.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":1,"column":1,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":1,"endColumn":18},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":26,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":58},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'data' is assigned a value but never used.","line":34,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'data' is assigned a value but never used.","line":52,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":52,"endColumn":21}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"require('dotenv').config({ path: '.env.local' });\r\nconst { createClient } = require('@supabase/supabase-js');\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\nconst supabaseKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\r\n\r\nif (!supabaseUrl || !supabaseKey) {\r\n    console.error('Missing Supabase environment variables');\r\n    process.exit(1);\r\n}\r\n\r\nconst supabase = createClient(supabaseUrl, supabaseKey);\r\n\r\nasync function testViews() {\r\n    const views = [\r\n        'v_admin_kpis_today',\r\n        'v_admin_ai_usage_30d',\r\n        'v_admin_lead_sources_7d',\r\n        'v_admin_subscriptions_breakdown',\r\n        'v_admin_jobs_queue',\r\n        'v_admin_contest_live_status',\r\n        'v_admin_affiliate_performance',\r\n        'v_coppa_consent_coverage',\r\n        'v_coppa_pending_requests',\r\n        'v_coppa_vendor_health',\r\n        'v_coppa_retention_enforcement',\r\n        'v_coppa_admin_access_log',\r\n        'v_coppa_incident_dashboard',\r\n        'v_coppa_metrics_today'\r\n    ];\r\n\r\n    console.log('--- Testing Views ---');\r\n    for (const view of views) {\r\n        const { data, error } = await supabase.from(view).select('*').limit(1);\r\n        if (error) {\r\n            console.error(`Γ¥î View \"${view}\" failed:`, error.message);\r\n        } else {\r\n            console.log(`Γ£à View \"${view}\" is accessible.`);\r\n        }\r\n    }\r\n}\r\n\r\nasync function testRPCs() {\r\n    console.log('\\n--- Testing RPCs ---');\r\n    const rpcs = [\r\n        'rpc_check_ai_limit',\r\n        'rpc_verify_parental_consent'\r\n    ];\r\n\r\n    for (const rpc of rpcs) {\r\n        // We try to call them with dummy values; they might fail if logic depends on data, but we check if they exist\r\n        const { data, error } = await supabase.rpc(rpc, {\r\n            p_user_id: '00000000-0000-0000-0000-000000000000',\r\n            p_feature: 'story_studio',\r\n            p_child_id: '00000000-0000-0000-0000-000000000000',\r\n            p_scope: 'basic_platform'\r\n        });\r\n\r\n        if (error && error.message.includes('function') && error.message.includes('does not exist')) {\r\n            console.error(`Γ¥î RPC \"${rpc}\" does not exist.`);\r\n        } else {\r\n            console.log(`Γ£à RPC \"${rpc}\" exists (called, result may be null/error due to dummy data).`);\r\n        }\r\n    }\r\n}\r\n\r\nasync function runTests() {\r\n    await testViews();\r\n    await testRPCs();\r\n}\r\n\r\nrunTests();\r\n","usedDeprecatedRules":[]}]

